(this["webpackJsonpspex-webapp-react"]=this["webpackJsonpspex-webapp-react"]||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),s=n(3),o=n.n(s);n(13),n(14);var r=function(e){let{taskType:t,updateConfig:n}=e;return l.a.createElement("div",{id:"task-container"},l.a.createElement("h3",null,"Select a Task"),l.a.createElement("div",{className:"image-selection-grid"},l.a.createElement("button",{type:"button",className:"task-button "+("image"===t?"selected":""),onClick:()=>n("task","image")},l.a.createElement("span",{role:"img","aria-label":"image"},"\ud83d\uddbc\ufe0f")," Image"),l.a.createElement("button",{type:"button",className:"task-button "+("text"===t?"selected":""),onClick:()=>n("task","text")},l.a.createElement("span",{role:"img","aria-label":"text"},"\ud83d\udcc4")," Text")))};var c=function(e){let{selectedContextId:t,numContexts:n,taskType:a,contextText:s,updateConfig:o}=e;return a?"image"===a?l.a.createElement("div",{id:"context-container"},l.a.createElement("h3",null,"Select an Image"),l.a.createElement("div",{className:"image-selection-grid",id:"image-context-selection-grid"},[...Array(n).keys()].map(e=>l.a.createElement("div",{key:e,className:"context-image-button "+(t===e?"selected":""),onClick:()=>o("selectedContextID",e)},l.a.createElement("img",{src:`/spex-webapp/assets/image_${e}.png`,alt:"Option"}))))):"text"===a?l.a.createElement("div",{id:"context-container"},l.a.createElement("h3",null,"Select a Context"),l.a.createElement("div",{className:"text-selection-grid"},[...Array(n).keys()].map(e=>l.a.createElement("button",{key:e,type:"button",className:"context-text-button "+(t===e?"selected":""),onClick:()=>o("selectedContextID",e)},s[e])))):null:null};var i=function(e){let{selectedPromptId:t,numPrompts:n,taskType:a,promptText:s,updateConfig:o}=e;return a&&null!==n?l.a.createElement("div",{id:"prompt-container"},l.a.createElement("h3",null,"Select a Prompt"),l.a.createElement("div",{className:"text-selection-grid"},[...Array(n).keys()].map(e=>l.a.createElement("button",{key:e,type:"button",className:"prompt-button "+(t===e?"selected":""),onClick:()=>o("selectedPromptID",e)},s[e])))):null};var u=function(e){let{config:t,updateConfig:n}=e;return l.a.createElement("div",{className:"sidebar"},l.a.createElement("h2",null,l.a.createElement("span",{role:"img","aria-label":"sunglasses"},"\ud83d\udd76\ufe0f")," SPEX"),l.a.createElement(r,{taskType:t.task,updateConfig:n}),l.a.createElement(c,{selectedContextId:t.selectedContextID,numContexts:t.numContexts,taskType:t.task,contextText:t.contextText,updateConfig:n}),l.a.createElement(i,{selectedPromptId:t.selectedPromptID,numPrompts:t.numPrompts,taskType:t.task,promptText:t.promptText,updateConfig:n}))};var m=function(e){let{config:t,changeSelection:n}=e;const{task:a,selectedContextID:s,numFeatures:o}=t;return a&&null!==s?"image"===a?l.a.createElement("div",{className:"main-content"},l.a.createElement("div",{className:"grid-container"},[...Array(o).keys()].map(e=>l.a.createElement("div",{key:e,className:"patch",id:"patch-"+e,onClick:()=>n(e)},l.a.createElement("img",{src:`/spex-webapp/assets/image_${s}/split_${e}.png`,alt:"Part"}),l.a.createElement("div",{className:"patch-overlay"}),l.a.createElement("div",{className:"patch-text",style:{visibility:"hidden"}}))))):"text"===a?l.a.createElement("div",{className:"main-content"},l.a.createElement("div",{className:"text-container"},[...Array(o).keys()].map(e=>l.a.createElement("div",{key:e,className:"token-wrapper",id:"token-"+e,onClick:()=>n(e),style:{visibility:"hidden"}},l.a.createElement("div",{className:"token-text"},"0"),l.a.createElement("span",{className:"inline-token"}))))):void 0:null};function d(e,t,n,a){function l(e){let t=parseInt(e.replace("#",""),16);return[t>>16&255,t>>8&255,255&t]}e=Math.max(-1,Math.min(1,e));let s,o,r,c=l(n),i=l(t),u=l(a),m=(e+1)/2;return m<.5?(m*=2,s=Math.round(i[0]+(u[0]-i[0])*m),o=Math.round(i[1]+(u[1]-i[1])*m),r=Math.round(i[2]+(u[2]-i[2])*m)):(m=2*(m-.5),s=Math.round(u[0]+(c[0]-u[0])*m),o=Math.round(u[1]+(c[1]-u[1])*m),r=Math.round(u[2]+(c[2]-u[2])*m)),function(e,t,n){return"#"+(1<<24|e<<16|t<<8|n).toString(16).slice(1).toUpperCase()}(s,o,r)}var p=function(){const[e,t]=Object(a.useState)({contextData:null,task:null,selectedContextID:null,selectedPromptID:null,numContexts:null,contextText:[],numPrompts:null,promptText:[],tokens:[],numFeatures:12}),[n,s]=Object(a.useState)({coefficients:null,selectedFeatures:new Set,featureValues:null});return Object(a.useEffect)(()=>{fetch("/spex-webapp/assets/config.json").then(e=>e.json()).then(e=>{t(t=>({...t,contextData:e}))})},[]),Object(a.useEffect)(()=>{"text"===e.task&&null!==e.selectedContextID&&function(e){for(let t=0;t<""+e.length;t++){let n=document.getElementById("token-"+t);n.getElementsByClassName("inline-token")[0].textContent=e[t],n.style.visibility="visible"}}(e.tokens),null!==e.task&&null!==e.selectedContextID&&null!==e.selectedPromptID&&async function(e,t,n){const a=await fetch(`/spex-webapp/assets/spex/${e}/context_${t}/prompt_${n}.json`);return await a.json()}(e.task,e.selectedContextID,e.selectedPromptID).then(e=>{s(t=>({...t,coefficients:e}))})},[e]),Object(a.useEffect)(()=>{null!==e.selectedPromptID&&async function(e,t,n){let a=new Array(n).fill(0),l={};for(let c in e){var s="0".repeat(n).split(""),o=e[c];for(let e=0;e<n;e++)"1"===c[e]&&(t.has(e)?o*=-1:s[e]="1");l[s=s.join("")]=s in l?l[s]+o:o}for(let c in l)for(let e=0;e<n;e++)"1"===c[e]&&(a[e]+=l[c]**2);let r=Math.max(...a);return a=0!==r?a.map(e=>e/r):a.map(e=>0),a}(n.coefficients,n.selectedFeatures,e.numFeatures).then(e=>{s(t=>({...t,featureValues:e}))})},[e,n.coefficients,n.selectedFeatures]),Object(a.useEffect)(()=>{null!==n.featureValues&&("text"===e.task?function(e,t,n,a){for(let s=0;s<""+e;s++){let e=document.getElementById("token-"+s),o=e.getElementsByClassName("inline-token")[0],r=e.getElementsByClassName("token-text")[0],c=getComputedStyle(document.documentElement),i=c.getPropertyValue("--overlay-positive-color").trim(),u=c.getPropertyValue("--overlay-negative-color").trim(),m=c.getPropertyValue("--overlay-default-color").trim(),p=c.getPropertyValue("--border-selected-color").trim();c.getPropertyValue("--border-default-color").trim();if(a)if(t.has(s))r.textContent="",r.style.visibility="hidden",o.style.backgroundColor=p+"60",o.style.border="3px solid "+p;else{r.textContent=n[s].toFixed(2),r.style.visibility="visible";var l=d(n[s],u,i,m);o.style.backgroundColor=l+"60",o.style.border="3px solid "+l,r.style.color=""+l}else r.textContent="",r.style.visibility="hidden",o.style.backgroundColor=m+"60",o.style.border="3px solid "+m}}(e.numFeatures,n.selectedFeatures,n.featureValues,null!==e.selectedPromptID):"image"===e.task&&function(e,t,n,a){for(let s=0;s<""+e;s++){let e=document.getElementById("patch-"+s),o=e.querySelector("img"),r=e.getElementsByClassName("patch-overlay")[0],c=e.getElementsByClassName("patch-text")[0],i=getComputedStyle(document.documentElement),u=i.getPropertyValue("--overlay-positive-color").trim(),m=i.getPropertyValue("--overlay-negative-color").trim(),p=i.getPropertyValue("--overlay-default-color").trim(),y=i.getPropertyValue("--border-selected-color").trim(),x=i.getPropertyValue("--border-default-color").trim();if(a)if(t.has(s))c.textContent="",c.style.visibility="hidden",o.style.border="6px solid "+y,r.style.border="6px solid "+y,r.style.backgroundColor=p+"60";else{c.textContent=n[s].toFixed(2),c.style.visibility="visible";var l=d(n[s],m,u,p);o.style.border="6px solid "+l,r.style.border="6px solid "+l,c.style.color=""+l,r.style.backgroundColor=l+"60"}else c.textContent="",c.style.visibility="hidden",o.style.border="6px solid "+x,r.style.border="6px solid "+x,r.style.backgroundColor="#00000000"}}(e.numFeatures,n.selectedFeatures,n.featureValues,null!==e.selectedPromptID))},[e,n.selectedFeatures,n.featureValues]),l.a.createElement("div",{className:"App"},l.a.createElement(u,{config:e,updateConfig:(e,n)=>{t(t=>{const a={...t,[e]:n};if("task"===e){const e=a.contextData[n];a.numContexts=e.length,a.contextText=e.map(e=>e.context_title),a.selectedContextID=null,a.selectedPromptID=null,a.numPrompts=null,a.promptText=[]}if("selectedContextID"===e){const e=a.contextData[a.task][n];a.numPrompts=e.prompts.length,a.promptText=e.prompts,a.selectedPromptID=null,"text"===a.task?(a.tokens=e.context.split(" "),a.numFeatures=a.tokens.length):"image"===a.task&&(a.tokens=[],a.numFeatures=12)}return a.selectedFeatures=new Set,a})}}),l.a.createElement(m,{config:e,changeSelection:t=>{if(null!==e.selectedContextID&&null!==e.selectedPromptID){const e=n.selectedFeatures.has(t);s(n=>{if(null===t)return n;const a={...n,selectedFeatures:new Set(n.selectedFeatures)};return e?a.selectedFeatures.delete(t):a.selectedFeatures.add(t),a})}}}))};var y=e=>{e&&e instanceof Function&&n.e(3).then(n.bind(null,16)).then(t=>{let{getCLS:n,getFID:a,getFCP:l,getLCP:s,getTTFB:o}=t;n(e),a(e),l(e),s(e),o(e)})};o.a.createRoot(document.getElementById("root")).render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(p,null))),y()},4:function(e,t,n){e.exports=n(15)}},[[4,1,2]]]);
//# sourceMappingURL=main.2b1c631a.chunk.js.map